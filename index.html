<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Pipstagram</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:0;background:#000;color:#fff;font-family:Arial}
.hidden{display:none}
header{padding:10px;border-bottom:1px solid #222;display:flex;justify-content:space-between}
nav{position:fixed;bottom:0;width:100%;display:flex;justify-content:space-around;background:#000;border-top:1px solid #222}
nav button{background:none;border:none;color:white;font-size:22px}
section{padding:10px;padding-bottom:80px}
input,button{padding:10px;margin:5px;border-radius:6px;border:none}
button{background:#0095f6;color:white}
video{width:100%;height:100vh;object-fit:cover}
.reelActions{position:absolute;right:10px;bottom:100px}
.reelActions button{display:block;margin:10px 0}
.user{padding:10px;border-bottom:1px solid #222;cursor:pointer}
</style>
</head>
<body>

<div id="login">
<h2>ğŸ“¸ Pipstagram</h2>
<input id="email" placeholder="E-posta">
<input id="pass" type="password" placeholder="Åifre">
<button onclick="register()">Kaydol</button>
<button onclick="loginUser()">GiriÅŸ</button>
</div>

<div id="app" class="hidden">

<header>
<b>Pipstagram</b>
<span onclick="show('notifications')">ğŸ””</span>
</header>

<section id="reels"></section>

<section id="comments" class="hidden">
<h3>Yorumlar</h3>
<input id="commentText" placeholder="Yorum yaz">
<button onclick="sendComment()">GÃ¶nder</button>
<div id="commentList"></div>
</section>

<section id="dm" class="hidden">
<h3>DM</h3>
<div id="dmUsers"></div>
<div id="chat" class="hidden">
<div id="messages"></div>
<input id="msgText" placeholder="Mesaj">
<button onclick="sendMessage()">GÃ¶nder</button>
</div>
</section>

<section id="profile" class="hidden">
<h3>Profil DÃ¼zenle</h3>
<input id="newUsername" placeholder="KullanÄ±cÄ± adÄ±">
<input id="photoUrl" placeholder="Profil foto URL">
<button onclick="saveProfile()">Kaydet</button>
</section>

<section id="notifications" class="hidden">
<h3>Bildirimler</h3>
<div id="notifyList"></div>
</section>

<nav>
<button onclick="show('reels')">ğŸ¬</button>
<button onclick="show('dm')">ğŸ’¬</button>
<button onclick="show('profile')">ğŸ‘¤</button>
</nav>

</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
apiKey:"AIzaSyCWmJVnZ4LIB07cPM8t_Run-1indRrDm9s",
authDomain:"pipstagram-5b98e.firebaseapp.com",
projectId:"pipstagram-5b98e"
});

const auth=firebase.auth();
const db=firebase.firestore();
let activeReel=null, activeChat=null;

function show(id){
document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
document.getElementById(id).classList.remove("hidden");
}

function register(){
auth.createUserWithEmailAndPassword(email.value,pass.value)
.then(r=>db.collection("users").doc(r.user.uid).set({username:email.value.split("@")[0]}));
}
function loginUser(){auth.signInWithEmailAndPassword(email.value,pass.value);}

auth.onAuthStateChanged(u=>{
if(u){
login.classList.add("hidden");
app.classList.remove("hidden");
loadReels(); loadDMUsers(); loadNotifications();
}
});

/* ğŸ¬ REELS */
function loadReels(){
db.collection("reels").onSnapshot(s=>{
reels.innerHTML="";
s.forEach(d=>{
reels.innerHTML+=`
<div style="position:relative">
<video src="${d.data().url}" autoplay loop muted></video>
<div class="reelActions">
<button onclick="likeReel('${d.id}')">â¤ï¸</button>
<button onclick="openComments('${d.id}')">ğŸ’¬</button>
</div>
</div>`;
});
});
}

/* â¤ï¸ LIKE */
function likeReel(id){
db.collection("likes").doc(auth.currentUser.uid+"_"+id).set({
reel:id, uid:auth.currentUser.uid
});
db.collection("notifications").add({to:"owner",text:"Reels beÄŸenildi"});
}

/* ğŸ’¬ COMMENT */
function openComments(id){activeReel=id;show("comments");}
function sendComment(){
db.collection("comments").add({
reel:activeReel,
text:commentText.value,
uid:auth.currentUser.uid
});
}

/* ğŸ’¬ DM */
function loadDMUsers(){
db.collection("users").onSnapshot(s=>{
dmUsers.innerHTML="";
s.forEach(u=>{
if(u.id!==auth.currentUser.uid)
dmUsers.innerHTML+=`<div class="user" onclick="openChat('${u.id}')">${u.data().username}</div>`;
});
});
}
function openChat(uid){
activeChat=uid; chat.classList.remove("hidden");
db.collection("dm").where("chat","==",[auth.currentUser.uid,uid].sort().join("_"))
.onSnapshot(s=>{
messages.innerHTML="";
s.forEach(m=>messages.innerHTML+=`<p>${m.data().text}</p>`);
});
}
function sendMessage(){
db.collection("dm").add({
chat:[auth.currentUser.uid,activeChat].sort().join("_"),
text:msgText.value
});
}

/* ğŸ”” NOTIFICATIONS */
function loadNotifications(){
db.collection("notifications").onSnapshot(s=>{
notifyList.innerHTML="";
s.forEach(n=>notifyList.innerHTML+=`<p>${n.data().text}</p>`);
});
}

/* ğŸ‘¤ PROFILE EDIT */
function saveProfile(){
db.collection("users").doc(auth.currentUser.uid).update({
username:newUsername.value,
photo:photoUrl.value
});
alert("Profil gÃ¼ncellendi");
}
</script>
</body>
</html>










  














